{% extends "MainpageBase.html" %}
{% block title %} profile {% endblock %}

{% block csslink %}
    <link rel="stylesheet" href="../static/css/searchResult.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=3.0, user-scalable=yes" />
{% endblock %}

{% block body %}

    <div class="shop-products-frame">
        <h2>Searching Results</h2>
        <ul class="search-products-list">
            {% for product in page_data %}
                <li class="search-product-item">
                    <a class="search-a-tag-left" href="/product?id={{ product.id }}">
                        <div class="search-product-pic-frame">
                            <img src="{{ url_for("static", filename='product_img/' + product.picture_address) }}"/>
                        </div>
                    </a>
                    <a class="search-a-tag-right" href="/product?id={{ product.id }}">
                        <div class="search-product-info-frame">
                            <div class="search-product-flex-frame">
                                <h3>{{ product.name }}</h3>
                                <div class="search-product-description">
                                    {{ product.description }}
                                </div>
                                <div class="search-product-unit-price">
                                    $ {{ product.price }}
                                </div>
                            </div>
                        </div>
                    </a>
                </li>
            {% endfor %}
        </ul>
    </div>

{% endblock %}

{% block jsLink %}

    <script>
    // get all the elements needed to be switched
    const shop_products_frame = document.getElementsByClassName("shop-products-frame")[0];
    const search_product_item = document.getElementsByClassName("search-product-item")[0];
    const search_product_flex_frame = document.getElementsByClassName("search-product-flex-frame")[0];
    const mode_img = document.getElementById("mode_img_id")
    loadBackground()

    function loadBackground() {
        let xhr = new XMLHttpRequest();
        xhr.open('GET', '/mode?type=get', true)
        xhr.send()
        xhr.onload = () => {
            let response = JSON.parse(xhr.responseText)
            if (response.message === "dark") {
                dark_mode()
                mode_img.src = "../static/images/dark.png"
            }
        }
    }

    function switchMode() {
        let xhr = new XMLHttpRequest();
        xhr.open('GET', '/mode?type=switch', true)
        xhr.send()
        xhr.onload = () => {
            let response = JSON.parse(xhr.responseText)
            if (response.message === "dark") {
                dark_mode()
                mode_img.src = "../static/images/dark.png"
            } else {
                light_mode()
                mode_img.src = "../static/images/light.png"
            }
        }
    }

    function light_mode(){
        // body background white
        document.body.style.background = '#ffffff';
        // remove dark mode classes
        shop_products_frame.classList.remove('DARKMODE_TEXT');
        search_product_item.classList.remove('DARKMODE_BACKGROUND_CARD');
        search_product_flex_frame.classList.remove('DARKMODE_TEXT');
    }

    function dark_mode(){
        // body background dark
        document.body.style.background = '#2F2F33FF'
        // add dark mode classes
        shop_products_frame.classList.add('DARKMODE_TEXT');
        search_product_item.classList.add('DARKMODE_BACKGROUND_CARD');
        search_product_flex_frame.classList.add('DARKMODE_TEXT');
    }

    </script>

{% endblock %}